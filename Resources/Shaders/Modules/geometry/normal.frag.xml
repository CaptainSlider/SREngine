<module name="normal" type="fragment">
    <layouts>
        <normalMap type="sampler2D" location="1" IO="uniform"/>
        <TexCoord type="vec2" location="0" IO="input"/>
    </layouts>
    <segments priority="1">
        <output>
            <vec3 name="normal"/>
        </output>
        <input>
            <vec3 name="color" default="vec3(1, 1, 1)"/>
        </input>
        <segment code="
            vec3 normal = texture(normalMap, TexCoord).rgb;
            normal = normalize(normal * 2.0 - 1.0);">
            <conditions><ifdef name="GBUFFER"/></conditions>
        </segment>
        <segment code="
            vec3 normal = texture(normalMap, TexCoord).rgb;
            normal = normalize(normal * 2.0 - 1.0);">
            <conditions><ifndef name="GBUFFER"/></conditions>
        </segment>
    </segments>
</module>